<ui:component xmlns="http://www.w3.org/1999/xhtml"
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:composite="http://java.sun.com/jsf/composite"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:f="http://java.sun.com/jsf/core"
              xmlns:c="http://java.sun.com/jsp/jstl/core">

    <composite:interface componentType="at.irian.PaginatorComponent">

        <!-- the referencing table which must be present in the same naming container as our component -->
        <composite:attribute name="forTable" required="true"/>

        <!-- the value pointing to a pagination controller object -->
        <composite:attribute name="value" required="true"/>

    </composite:interface>

    <composite:implementation>
        <h:panelGroup id="pagingController">
            <!--
                todo we have to set a component here because we have to make the connection between
                this markup and the corresponding table
            -->


            <h:commandLink id="first" value="#{msgs.pagination_first}" rendered="#{! cc.value.isInFirstWindow()}"
                           onclick="jsf.ajax.request(this, event, {execute:'@this', render:'#{cc.forTableClientId} #{cc.enclosingContainerClientId}'});return false;"
                    >
                <f:setPropertyActionListener value="0" target="#{cc.value.lastPageAccessed}"/>

            </h:commandLink>

            <ui:repeat value="#{cc.value.fetchPagesWindow()}" varStatus="s" var="curVal">
                <h:commandLink id="page_select" action="groupList" value="${curVal}"
                               rendered="#{curVal ne cc.value.lastPageAccessed}"
                               onclick="jsf.ajax.request(this, event, {execute:'@this', render:'#{cc.forTableClientId} #{cc.enclosingContainerClientId}'});return false;"
                        >
                    <f:setPropertyActionListener value="${curVal}" target="#{cc.value.lastPageAccessed}"/>

                </h:commandLink>
                <h:outputFormat value="${curVal}" rendered="#{curVal eq cc.value.lastPageAccessed}"/>
            </ui:repeat>

            <h:commandLink id="last" value="#{msgs.pagination_last}" rendered="#{! cc.value.isInLastWindow()}"
                           onclick="jsf.ajax.request(this, event, {execute:'@this', render:'#{cc.forTableClientId} #{cc.enclosingContainerClientId}'});return false;"
                    >
                <f:setPropertyActionListener value="0" target="#{cc.value.lastPageAccessed}"/>
            </h:commandLink>

        </h:panelGroup>
    </composite:implementation>

</ui:component>
