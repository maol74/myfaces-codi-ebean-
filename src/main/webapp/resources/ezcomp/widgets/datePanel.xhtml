<ui:component xmlns=""
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:composite="http://java.sun.com/jsf/composite"
              xmlns:f="http://java.sun.com/jsf/core"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:c="http://java.sun.com/jsp/jstl/core"
              xmlns:ezw="http://java.sun.com/jsf/composite/ezcomp/widgets">
    <composite:interface componentType="at.irian.DatePicker">
        <composite:attribute name="id" required="true"/>
        <composite:attribute name="javascriptVar" required="false"></composite:attribute>
        <composite:attribute name="javascriptClass" default="extras.apache.DatePanel"/>


        <composite:attribute name="styleClass"/>
        <composite:attribute name="style"/>

        <composite:attribute name="rendered" default="true"/>


    </composite:interface>
    <composite:implementation>
        <!--
        <h:outputScript library="script" name="_behaviors/_Behavior.js"/>
        <h:outputScript library="script" name="_behaviors/_KeyboardAware.js"/>
        <h:outputScript library="script" name="_behaviors/_MouseAware.js"/>
        <h:outputScript library="script" name="_behaviors/_Focusable.js"/>


        <h:outputScript library="script" name="input/DatePanel.js"/>
        -->

        <div id="#{cc.clientId}" class="#{cc.attrs.styleClass} datePanel">
            <h:panelGroup id="#{cc.clientId}" layout="block" rendered="#{cc.attrs.rendered}">
                <h:panelGroup id="componentBinding" style="display:none">
                    <f:event type="preRenderComponent" listener="#{cc.preRenderInput}"/>
                </h:panelGroup>
                <h:panelGroup id="header" layout="block" styleClass="header">

                </h:panelGroup>

                <h:panelGroup id="controls" layout="block" styleClass="controls">
                    <!-- todo replace the command links with image buttons -->
                    <h:commandLink value="&lt;&lt;" styleClass="previousYear" actionListener="#{cc.previousYear}">
                        <f:ajax render="header body controls" execute="@this"/>
                    </h:commandLink>
                    <h:commandLink value="&lt;" styleClass="previousMonth" actionListener="#{cc.previousMonth}">
                        <f:ajax render="header body controls" execute="@this"/>
                    </h:commandLink>
                    <h:inputText value="" styleClass="year"></h:inputText>
                    <h:commandLink value="&gt;" styleClass="nextMonth" actionListener="#{cc.nextMonth}">
                        <f:ajax render="header body controls" execute="@this"/>
                    </h:commandLink>
                    <h:commandLink value="&gt;&gt;" styleClass="nextYear" actionListener="#{cc.nextYear}">
                        <f:ajax render="header body controls" execute="@this"/>
                    </h:commandLink>
                </h:panelGroup>

                <div class="title row">
                    <!-- TODO add the beginning of week handling here -->
                    <div class="cell column col_0">Mon</div>
                    <div class="cell column col_1">Tue</div>
                    <div class="cell column col_2">We</div>
                    <div class="cell column col_3">Th</div>
                    <div class="cell column col_4">Fr</div>
                    <div class="cell column col_5">Sat</div>
                    <div class="cell column col_6">Sun</div>
                    <div class="rowEnd"/>
                </div>
                <!-- foreach the controls here -->
                <!-- foreach the controls here end -->
                <h:panelGroup id="body" layout="block" class="body row">
                    <ui:repeat value="#{cc.displayData.weeks}" var="week" varStatus="row">
                        <div class="week row row_#{row.index}">
                            <ui:repeat value="#{week.days}" var="day" varStatus="col">
                                <div class="day cell column col_#{col.index}">
                                    <h:commandLink id="daySelection" onclick="jsf.ajax.request(this, event,{
                                        execute:'@this', render:'#{cc.clientId}:header #{cc.clientId}:controls #{cc.clientId}:componentBinding', mf_dp:'1000'
                                    }); return false;">
                                        <h:outputFormat value="#{day.day}"/>
                                    </h:commandLink>
                                </div>
                            </ui:repeat>
                        </div>
                        <div class="rowEnd"/>
                    </ui:repeat>
                </h:panelGroup>
            </h:panelGroup>
        </div>
    </composite:implementation>
</ui:component>